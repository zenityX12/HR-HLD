<!DOCTYPE html>
<html>
<head>
    <title>ลงทะเบียนวันหยุด (Google Calendar)</title>
    <script>
        async function submitToCalendar() {
            const name = document.getElementById("name").value;
            const date = document.getElementById("date").value;
            const scriptURL = "https://script.google.com/macros/s/AKfycbzkIXg3Oo0QJTJYp7rf1eTyM8eHBLxuC0gz50luqBBl_mn_Ox4cvap2gDSSNAwXiSo4/exec";  // ใส่ URL ของ Google Apps Script ที่ Deploy แล้ว

            const data = { name, date };

            try {
                const response = await fetch(scriptURL, {
                    method: "POST",
                    mode: "no-cors",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify(data)
                });
                alert("เพิ่มวันหยุดลงใน Google Calendar เรียบร้อยแล้ว!");
            } catch (error) {
                alert("เกิดข้อผิดพลาด: " + error);
            }
        }
    </script>
</head>
<body>
    <h1>ลงทะเบียนวันหยุด (Google Calendar)</h1>
    <form onsubmit="event.preventDefault(); submitToCalendar();">
        <label for="name">ชื่อ:</label>
        <input type="text" id="name" required><br>
        <label for="date">เลือกวันหยุด:</label>
        <input type="date" id="date" required><br>
        <button type="submit">บันทึกวันหยุด</button>
    </form>
</body>
</html>
